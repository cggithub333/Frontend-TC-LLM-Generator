#!/usr/bin/env sh

MSG_FILE="$1"
MSG="$(cat "$MSG_FILE")"

# ------------------------------------------------------------
# Skip automatic Git commits (merge / revert)
# ------------------------------------------------------------
case "$MSG" in
  Merge*|Revert*)
    exit 0
    ;;
esac

# ------------------------------------------------------------
# Allowed commit types
# ------------------------------------------------------------
PATTERN='^(feat|fix|update|debug|test|refact|chore): .+'

# ------------------------------------------------------------
# Validate commit message format
# ------------------------------------------------------------
if ! printf '%s\n' "$MSG" | grep -Eq "$PATTERN"; then
  echo "‚ùå Invalid commit message format"
  echo ""
  echo "Expected format:"
  echo "  type: message"
  echo ""
  echo "Allowed types:"
  echo "  feat, fix, update, debug, test, refact, chore"
  echo ""
  echo "Examples:"
  echo "  feat: add login endpoint"
  echo "  update: improve documentation"
  echo "  refact: restructure Twitter schemas"
  echo "  fix: resolve crash on startup"
  echo ""
  exit 1
fi

# ------------------------------------------------------------
# All checks passed
# ------------------------------------------------------------
exit 0
